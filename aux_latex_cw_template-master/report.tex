%FILL THESE IN
\def\mytitle{Coursework Report}
\def\mykeywords{Fill, These, In, So, google, can, find, your, report}
\def\myauthor{Alistair Mckay	}
\def\contact{40207511@napier.ac.uk}
\def\mymodule{Module Title (SET00000)}
%YOU DON'T NEED TO TOUCH ANYTHING BELOW
\documentclass[10pt, a4paper]{article}
\usepackage[a4paper,outer=1.5cm,inner=1.5cm,top=1.75cm,bottom=1.5cm]{geometry}
\twocolumn
\usepackage{graphicx}
\graphicspath{{./images/}}
%colour our links, remove weird boxes
\usepackage[colorlinks,linkcolor={black},citecolor={blue!80!black},urlcolor={blue!80!black}]{hyperref}
%Stop indentation on new paragraphs
\usepackage[parfill]{parskip}
%% all this is for Arial
\usepackage[english]{babel}
\usepackage[T1]{fontenc}
\usepackage{uarial}
\renewcommand{\familydefault}{\sfdefault}
%Napier logo top right
\usepackage{watermark}
%Lorem Ipusm dolor please don't leave any in you final repot ;)
\usepackage{lipsum}
\usepackage{xcolor}
\usepackage{listings}
%give us the Capital H that we all know and love
\usepackage{float}
%tone down the linespacing after section titles
\usepackage{titlesec}
%Cool maths printing
\usepackage{amsmath}
%PseudoCode
\usepackage{algorithm2e}

\titlespacing{\subsection}{0pt}{\parskip}{-3pt}
\titlespacing{\subsubsection}{0pt}{\parskip}{-\parskip}
\titlespacing{\paragraph}{0pt}{\parskip}{\parskip}
\newcommand{\figuremacro}[5]{
    \begin{figure}[#1]
        \centering
        \includegraphics[width=#5\columnwidth]{#2}
        \caption[#3]{\textbf{#3}#4}
        \label{fig:#2}
    \end{figure}
}

\lstset{
	escapeinside={/*@}{@*/}, language=C++,
	basicstyle=\fontsize{8.5}{12}\selectfont,
	numbers=left,numbersep=2pt,xleftmargin=2pt,frame=tb,
    columns=fullflexible,showstringspaces=false,tabsize=4,
    keepspaces=true,showtabs=false,showspaces=false,
    backgroundcolor=\color{white}, morekeywords={inline,public,
    class,private,protected,struct},captionpos=t,lineskip=-0.4em,
	aboveskip=10pt, extendedchars=true, breaklines=true,
	prebreak = \raisebox{0ex}[0ex][0ex]{\ensuremath{\hookleftarrow}},
	keywordstyle=\color[rgb]{0,0,1},
	commentstyle=\color[rgb]{0.133,0.545,0.133},
	stringstyle=\color[rgb]{0.627,0.126,0.941}
}

\thiswatermark{\centering \put(336.5,-38.0){\includegraphics[scale=0.8]{logo}} }
\title{\mytitle}
\author{\myauthor\hspace{1em}\\\contact\\Edinburgh Napier University\hspace{0.5em}-\hspace{0.5em}\mymodule}
\date{}
\hypersetup{pdfauthor=\myauthor,pdftitle=\mytitle,pdfkeywords=\mykeywords}
\sloppy
\begin{document}
	\maketitle
	\begin{abstract}
	This report will outline the creation and implementation
	of a graphics coursework project. The aim of this project
	was to create a "the floor is lava" type scene, essentially
	a living room which has a floor made of lava.
	
	\end{abstract}
    
	\textbf{Keywords -- }{Cameras, Texturing, normal mapping, lighting}
    %START FROM HERE
	\section{Introduction}
	The scene featured in this report, which we shall call, "The floor is lava" was created in Microsoft's Visual studio platform in c++ using OpenGl and a graphics framework created and provided by Edinburgh Napier University. 
	
	The scene uses several different graphical techniques to create the overall effect. The main effects featured are grayscale, masking, texturing, lighting and a skybox.
	
	The motivation behind this project was to take what was learned during part one of the coursework and to build on what was learned while building 
\section{Post processing}

To build and improve upon the scene from part one of this coursework, it was decided to utilise several post processing effects.  

The first effect that was chosen to be used was wire framing. This was chosen as it is rather simple to implement and gives a cool effect when activated. I also provided to be useful while debugging errors in the scene as it gives us the ability to see clearly where objects are overlapping in the scene.

\figuremacro{h}{wireframe.png}{Wire frame}{ - The project in wire frame mode}{0.65}

A masking effect was also chosen to be part of the scene

\figuremacro{h}{mask.png}{Wire frame}{ - The project in wire frame mode}{1.0}

Something about grey scale

\figuremacro{h}{grayscale.png}{Wire frame}{ - The project in wire frame mode}{1.0}
\section{Rendering techniques}
During development, there were several rendering techniques added to the scene to improve upon it. 

One of the effects used as a skybox. A skybox 
	\section{Problems encountered}
	
Throughout the course of this project, several problems were encountered. The main problem encountered was an ongoing issue with the scenes lighting. The scene uses point lights and spotlights in an array which has an issue that means the lights are rendered incorrectly. The other issue encountered was an issue where the grey scale effect is rendered incorrectly. Given more time these issues would be fixed but unfortunately given the time constraints, fixing them is unfeasible. 
	
\section{Optimisation}
Upon completing this project, it was decided that it would be beneficial to investigate the code using facilities offered by Visual studio and its profiler function.The first thing that was done was add to the program, a frame rate counter that outputs to the command prompt as the project is running. This allowed for real time monitoring of the frame rate that the project was achieving and provided the ability to immediately investigate any drops in frame rate that came up.

\figuremacro{h}{hotpath.jpg}{Hot paths}{ - The hot paths of the project}{1.0}

The second thing that allowed for investigation of the code was visual studio's inbuilt profiler. The profiler allows for a graphical representation of your code to facilitate easier optimisation.
As you can see from the above figure, the render and load content sections of the project were the areas that took up the most of the CPU, or the "Hottest" parts of the project. 

\figuremacro{h}{render.jpg}{Render function}{ -The projects render function}{1.0}

The first function I looked at was the render function. As you can see by the above figure, there were certain aspects of the render function using a noticeable amount of the CPU
There are two noticeable sections of the render function that are using a significant amount of CPU load. They are the lines where we bind the spot lights and the point lights.  
These binding functions are only partially operational and both caused a frame rate drop to around 30 frames per second. After investigating further I managed to remove the frame rate drop but 
both functions however I was unfortunately unable to completely remove the issues that cause them to take up significant CPU load and work exactly as I intended. Given more time I would
like to fix the issues with these functions to make them fully operational.

\figuremacro{h}{loadcontent.png}{ImageTitle}{ - Model using high load}{1.0}

After investigating the render function I moved on the load content function. As you can see by the above figure, the profiler picked up on several areas of the function that were using a noticeable amount of CPU load. This can be put down to how doing a lot of loading will tend to use a lot of load however there was one part that the profiler picked up that was using a large 
amount of load. I assumed this was down to the amount of polygons in the model. After replacing the model with an alternative one the amount of load on decreased as you can see by the following figure.

\figuremacro{h}{replacementloadcontent.png}{ImageTitle}{ - Replacement model using lower load}{0.8}





   
\section{Related work}

The inspiration for the scene came from the game that
probably everybody played as a child in which the aim
was to get around the room by jumping and climbing over
the various furniture and by all means, not touching the
floor.

Inspiration was also gained from the in-development
game from Klei entitled, "Hot lava", which is based on
the childhood game. "Hot lava" which is currently in its
beta testing phase takes the childhood classic game and
takes it a step further with the player being able to see the
red hot lava on the ground and become fully immersed in
the game of dodging the dreaded lava that has replaced
the floor.

\section{Future work}
Between part one of this coursework and part two I was able to add several other features to improve to overall look and quality of the scene, however there are still some things
I would like to add to my project. For example, if I had more time to spend on this I would hope to add a few more houses outside of the window to give the appearance that we are in a house on a street.
I would also like to add a day/night cycle to the scene.
\section{Conclusion}

Overall, both parts of this coursework have been interesting to complete and have provided allot of worthwhile graphical knowledge. Part one taught many basic key skills that became very useful while developing part 2. The second part of the coursework built on the skills from part one and enabled us to gain valuable knowledge in core and more advanced concepts that will be of great help while working on future projects.  	
\bibliographystyle{ieeetr}
\bibliography{references}
		
\end{document}
